*{margin:0;padding:0;box-sizing:border-box;}
:root{
  --bg:#08080c;--bg2:#0e0e14;--bg3:#16161f;--bg4:#1e1e2a;--bg5:#262635;
  --brd:#2a2a3a;--brd2:#3a3a4f;
  --tx:#e8e6f0;--tx2:#a8a4b8;--tx3:#706c82;--tx4:#4a475a;
  --red:#ef4444;--blue:#3b82f6;--green:#10b981;--yellow:#f59e0b;--purple:#a855f7;--orange:#f97316;--cyan:#06b6d4;--pink:#ec4899;
  --radius:6px;--shadow:0 4px 16px rgba(0,0,0,.4);
}
body{font-family:'Inter','DM Sans','Segoe UI',sans-serif;background:var(--bg);color:var(--tx);overflow:hidden;height:100vh;font-size:13px;}
.app{display:flex;flex-direction:column;height:100vh;}
::selection{background:var(--blue);color:#fff;}

/* ── TOPBAR ── */
.topbar{min-height:48px;background:var(--bg2);border-bottom:1px solid var(--brd);display:flex;align-items:center;justify-content:space-between;padding:6px 16px;flex-shrink:0;z-index:50;flex-wrap:wrap;gap:6px;}
.logo{display:flex;align-items:center;gap:10px;}
.logo h1{font-size:15px;font-weight:700;letter-spacing:.5px;cursor:pointer;}
.logo h1:hover{color:var(--blue);}
.logo span{font-size:10px;color:var(--tx3);letter-spacing:.5px;}
.tba{display:flex;gap:6px;align-items:center;flex-wrap:wrap;}
.btn{padding:7px 13px;border-radius:var(--radius);border:1px solid var(--brd);background:var(--bg3);color:var(--tx2);font-family:inherit;font-size:12px;cursor:pointer;transition:all .15s;display:inline-flex;align-items:center;gap:5px;white-space:nowrap;line-height:1;}
.btn:hover{background:var(--bg4);color:var(--tx);border-color:var(--brd2);}
.btn:active{transform:scale(.97);}
.btn-p{background:var(--blue);border-color:var(--blue);color:#fff;}.btn-p:hover{background:#2563eb;border-color:#2563eb;}
.btn-d{background:var(--red);border-color:var(--red);color:#fff;}.btn-d:hover{background:#dc2626;}
.btn-s{padding:4px 8px;font-size:11px;}
.btn-icon{padding:6px 8px;font-size:14px;}
.badge{background:var(--orange);color:#fff;font-size:9px;padding:1px 6px;border-radius:8px;font-weight:700;min-width:18px;text-align:center;}
.view-modes{display:flex;gap:2px;background:var(--bg);border-radius:var(--radius);padding:2px;border:1px solid var(--brd);}
.view-mode{padding:5px 12px;border-radius:4px;font-size:11px;cursor:pointer;color:var(--tx3);border:none;background:none;font-family:inherit;transition:all .15s;}
.view-mode.active{background:var(--bg4);color:var(--tx);}
.view-mode:hover:not(.active){color:var(--tx2);}

/* ── TOOLBAR ── */
.toolbar{min-height:40px;background:var(--bg2);border-bottom:1px solid var(--brd);display:flex;align-items:center;padding:4px 16px;gap:10px;flex-wrap:wrap;flex-shrink:0;z-index:40;}
.toolbar label{font-size:10px;color:var(--tx3);text-transform:uppercase;letter-spacing:.5px;white-space:nowrap;font-weight:500;}
.toolbar select{padding:4px 8px;border-radius:4px;border:1px solid var(--brd);background:var(--bg3);color:var(--tx2);font-size:12px;font-family:inherit;cursor:pointer;outline:none;}
.toolbar select:focus{border-color:var(--blue);}
.sep{width:1px;height:22px;background:var(--brd);flex-shrink:0;}
.pill{padding:3px 10px;border-radius:12px;font-size:11px;cursor:pointer;border:1px solid;transition:all .15s;white-space:nowrap;user-select:none;font-weight:500;}
.pill.off{opacity:.2;}
.pill:hover{opacity:1;}

/* ── MAIN LAYOUT ── */
.main-wrap{display:flex;flex:1;overflow:hidden;position:relative;}

/* ── SCREENPLAY PANEL (LEFT) ── */
.sp-panel{width:0;background:var(--bg2);border-right:1px solid var(--brd);overflow:hidden;transition:width .25s ease;flex-shrink:0;display:flex;flex-direction:column;position:relative;z-index:30;}
.sp-panel.open{width:380px;}
.sp-resize{position:absolute;right:-3px;top:0;bottom:0;width:6px;cursor:col-resize;z-index:35;transition:background .15s;}
.sp-resize:hover,.sp-resize.active{background:var(--blue);}
.sp-header{padding:10px 14px;border-bottom:1px solid var(--brd);display:flex;justify-content:space-between;align-items:center;flex-shrink:0;background:var(--bg2);}
.sp-header h3{font-size:13px;font-weight:600;display:flex;align-items:center;gap:6px;}
.sp-toolbar{padding:6px 14px;border-bottom:1px solid var(--brd);display:flex;gap:4px;flex-wrap:wrap;flex-shrink:0;background:var(--bg3);}
.sp-episodes{flex:1;overflow-y:auto;padding:0;}

/* Episode tree */
.ep-tree{border-bottom:1px solid var(--brd);}
.ep-tree-hdr{padding:8px 14px;display:flex;align-items:center;gap:8px;cursor:pointer;transition:background .12s;user-select:none;}
.ep-tree-hdr:hover{background:var(--bg3);}
.ep-tree-hdr .arrow{font-size:10px;color:var(--tx3);transition:transform .2s;width:12px;}
.ep-tree-hdr .arrow.open{transform:rotate(90deg);}
.ep-tree-hdr .ep-info{flex:1;}
.ep-tree-hdr .ep-num{font-weight:600;font-size:12px;}
.ep-tree-hdr .ep-title{font-size:11px;color:var(--tx2);margin-left:6px;}
.ep-tree-hdr .ep-meta{font-size:10px;color:var(--tx3);font-family:'Courier New',monospace;}
.ep-tree-body{display:none;padding-left:8px;}
.ep-tree-body.open{display:block;}

/* Scene cards */
.scene-card{padding:8px 14px;border-bottom:1px solid rgba(42,42,58,.5);cursor:pointer;transition:background .12s;position:relative;}
.scene-card:hover{background:var(--bg3);}
.scene-card.active{background:var(--bg4);border-left:3px solid var(--blue);}
.scene-card-hdr{display:flex;justify-content:space-between;align-items:center;margin-bottom:4px;}
.scene-card-title{font-size:12px;font-weight:500;}
.scene-card-badges{display:flex;gap:4px;align-items:center;}
.scene-card-badge{font-size:9px;padding:1px 6px;border-radius:8px;background:var(--bg4);color:var(--tx3);}
.scene-card-chars{display:flex;gap:3px;margin-top:4px;flex-wrap:wrap;}
.scene-card-char{width:22px;height:22px;border-radius:50%;background:var(--bg5);font-size:9px;display:flex;align-items:center;justify-content:center;color:var(--tx2);border:1px solid var(--brd);}
.scene-card-body{display:none;margin-top:8px;padding-top:8px;border-top:1px solid var(--brd);}
.scene-card.expanded .scene-card-body{display:block;}

/* Scene editor */
.scene-editor{padding:8px;}
.scene-block{margin-bottom:6px;border-radius:4px;position:relative;}
.scene-block-action{padding:6px 8px;background:var(--bg3);border:1px solid var(--brd);border-radius:4px;min-height:30px;font-size:12px;color:var(--tx2);line-height:1.5;outline:none;}
.scene-block-action:focus{border-color:var(--blue);background:var(--bg4);}
.scene-block-dialogue{border:1px solid var(--brd);border-radius:4px;overflow:hidden;}
.scene-block-dialogue .char-line{padding:4px 8px;background:var(--bg4);font-size:11px;font-weight:600;color:var(--blue);display:flex;align-items:center;gap:6px;}
.scene-block-dialogue .char-line select{padding:2px 6px;font-size:11px;background:var(--bg3);border:1px solid var(--brd);color:var(--tx);border-radius:3px;font-family:inherit;}
.scene-block-dialogue .paren{padding:2px 8px;font-size:10px;color:var(--tx3);font-style:italic;}
.scene-block-dialogue .dial-text{padding:6px 8px;background:var(--bg3);min-height:28px;font-size:12px;color:var(--tx);outline:none;line-height:1.5;}
.scene-block-dialogue .dial-text:focus{background:var(--bg4);}
.scene-block-transition{padding:4px 8px;background:var(--bg4);border:1px solid var(--brd);border-radius:4px;text-align:center;font-size:11px;color:var(--tx3);text-transform:uppercase;letter-spacing:1px;}
.scene-meta-row{display:flex;gap:8px;margin-bottom:6px;}
.scene-meta-field{flex:1;display:flex;flex-direction:column;gap:2px;}
.scene-meta-field label{font-size:9px;color:var(--tx3);text-transform:uppercase;letter-spacing:.5px;font-weight:500;}
.scene-meta-field input,.scene-meta-field select{padding:4px 7px;border-radius:4px;border:1px solid var(--brd);background:var(--bg3);color:var(--tx);font-family:inherit;font-size:11px;outline:none;transition:border-color .15s;}
.scene-meta-field input:focus,.scene-meta-field select:focus{border-color:var(--blue);}
/* Screenplay text area */
.scene-screenplay-wrap{position:relative;margin-bottom:6px;}
.scene-screenplay-label{font-size:9px;color:var(--tx3);text-transform:uppercase;letter-spacing:.5px;font-weight:500;margin-bottom:3px;}
.scene-screenplay{min-height:120px;max-height:400px;overflow-y:auto;padding:8px 10px;border-radius:4px;border:1px solid var(--brd);background:var(--bg3);color:var(--tx);font-family:inherit;font-size:12px;line-height:1.7;outline:none;white-space:pre-wrap;word-wrap:break-word;}
.scene-screenplay:focus{border-color:var(--blue);background:var(--bg4);}
.scene-screenplay:empty::before{content:attr(data-placeholder);color:var(--tx4);pointer-events:none;}
.scene-screenplay .mention{color:var(--cyan);font-weight:600;background:rgba(6,182,212,.1);padding:0 3px;border-radius:3px;cursor:default;user-select:all;}
.mention-popup{position:absolute;left:0;top:0;min-width:180px;max-height:200px;overflow-y:auto;background:var(--bg2);border:1px solid var(--brd2);border-radius:var(--radius);box-shadow:var(--shadow);z-index:100;display:none;}
.mention-popup.open{display:block;}
.mention-popup .mp-item{padding:7px 12px;font-size:12px;cursor:pointer;display:flex;align-items:center;gap:8px;transition:background .1s;}
.mention-popup .mp-item:hover,.mention-popup .mp-item.active{background:var(--bg4);color:var(--cyan);}
.mention-popup .mp-item .mp-dot{width:8px;height:8px;border-radius:50%;flex-shrink:0;}
.mention-popup .mp-empty{padding:8px 12px;font-size:11px;color:var(--tx4);}
.scene-chars-row{display:flex;flex-wrap:wrap;gap:4px;margin-bottom:6px;}
.scene-char-tag{display:inline-flex;align-items:center;gap:4px;padding:2px 8px;border-radius:10px;font-size:10px;font-weight:500;border:1px solid var(--brd);background:var(--bg4);color:var(--tx2);}
.scene-char-tag .remove-char{cursor:pointer;opacity:.5;font-size:12px;line-height:1;}
.scene-char-tag .remove-char:hover{opacity:1;color:var(--red);}
.scene-block-acts{display:flex;gap:4px;margin-top:4px;padding:4px 0;}
.scene-block-acts .btn{font-size:10px;padding:3px 7px;}
.add-scene-btn{padding:8px 14px;display:flex;align-items:center;gap:6px;cursor:pointer;color:var(--tx3);font-size:12px;transition:all .15s;border:none;background:none;width:100%;text-align:left;font-family:inherit;}
.add-scene-btn:hover{background:var(--bg3);color:var(--blue);}

/* ── SCREENPLAY EDITOR (Professional) ── */
.sp-editor-wrap{flex:1;overflow-y:auto;background:#fff;padding:20px 20px 20px 20px;display:block;}
.sp-editor-page{width:100%;background:#fff;color:#111;font-family:'Courier New','Courier',monospace;font-size:12pt;line-height:1.2;position:relative;padding:20px 16px 100px 16px;}
.sp-el{position:relative;margin-bottom:12pt;outline:none;min-height:1em;white-space:pre-wrap;word-wrap:break-word;}
.sp-el:empty::before{content:attr(data-placeholder);color:#999;pointer-events:none;}
.sp-el.sp-action{/* full width default */}
.sp-el.sp-character{text-transform:uppercase;margin-left:37%;margin-bottom:0;}
.sp-el.sp-parenthetical{margin-left:31%;margin-right:31%;margin-bottom:0;}
.sp-el.sp-dialogue{margin-left:25%;margin-right:25%;margin-bottom:0;}
.sp-el.sp-transition{text-align:right;text-transform:uppercase;}
.sp-el:focus{background:#f0f7ff;border-radius:2px;}
.sp-el-type-badge{position:absolute;left:0;top:-14px;font:9px/1 'Inter',sans-serif;color:#888;background:#f5f5f5;padding:2px 6px;border-radius:3px;white-space:nowrap;pointer-events:none;}
.sp-autocomplete{position:absolute;background:#fff;border:1px solid #ccc;border-radius:4px;box-shadow:0 4px 12px rgba(0,0,0,.15);max-height:160px;overflow-y:auto;z-index:100;min-width:180px;display:none;}
.sp-autocomplete.open{display:block;}
.sp-autocomplete-item{padding:6px 12px;cursor:pointer;font:12px 'Inter',sans-serif;color:#333;}
.sp-autocomplete-item.active{background:#3b82f6;color:#fff;}
.sp-page-break{border-top:1px dashed #ccc;margin:20px 0;position:relative;height:0;}
.sp-page-break::after{content:attr(data-page);position:absolute;right:10px;top:-10px;font:10px 'Inter',sans-serif;color:#aaa;background:#fff;padding:0 6px;}
.sp-episode-divider{text-align:left;padding:20px 0;margin:30px 0;border-top:2px solid #333;font:bold 14pt 'Courier New',monospace;color:#333;}
.sp-editor-page.focus-mode .sp-el:not(:focus){opacity:0.3;transition:opacity .2s;}
.sp-editor-page.focus-mode .sp-el:focus{opacity:1;}
.sp-editor-toolbar{background:#f8f8f8;border-bottom:1px solid #ddd;padding:6px 16px;display:flex;align-items:center;gap:8px;flex-shrink:0;font-family:'Inter',sans-serif;}
.sp-editor-toolbar select,.sp-editor-toolbar button{padding:4px 10px;border:1px solid #ccc;border-radius:4px;background:#fff;font-size:12px;cursor:pointer;color:#333;font-family:'Inter',sans-serif;}
.sp-editor-toolbar button:hover{background:#e8e8e8;}
.sp-editor-toolbar button.active{background:#3b82f6;color:#fff;border-color:#3b82f6;}
.sp-editor-toolbar .sp-tb-sep{width:1px;height:22px;background:#ddd;flex-shrink:0;}
.sp-el.sp-flash{animation:sp-flash .6s ease;}
@keyframes sp-flash{0%{background:#bfdbfe;}100%{background:transparent;}}
/* Scene header bar */
.sp-scene-header{display:flex;align-items:center;gap:8px;padding:10px 12px;margin-top:24pt;background:#f8f9fa;border:1px solid #e0e0e0;border-radius:6px;font-family:'Inter',sans-serif;font-size:12px;flex-wrap:wrap;}
.sp-scene-header .sp-scene-num{font-weight:700;font-size:14px;color:#333;min-width:60px;white-space:nowrap;}
.sp-scene-header select{padding:3px 8px;border:1px solid #ccc;border-radius:4px;font-size:11px;background:#fff;color:#333;font-family:'Inter',sans-serif;}
.sp-scene-header input{padding:3px 8px;border:1px solid #ccc;border-radius:4px;font-size:11px;background:#fff;color:#333;font-family:'Inter',sans-serif;min-width:100px;flex:1;}
.sp-scene-header .sp-add-scene-btn{margin-left:auto;font:11px 'Inter',sans-serif;color:#3b82f6;cursor:pointer;background:none;border:1px solid #3b82f6;border-radius:4px;padding:3px 10px;white-space:nowrap;}
.sp-scene-header .sp-add-scene-btn:hover{background:#3b82f6;color:#fff;}
/* Block action buttons */
.sp-block-actions{display:flex;gap:6px;padding:4px 0;margin-top:4px;}
.sp-block-actions button{font:11px 'Inter',sans-serif;color:#3b82f6;cursor:pointer;background:none;border:1px dashed #ccc;border-radius:4px;padding:3px 10px;}
.sp-block-actions button:hover{background:#f0f7ff;border-color:#3b82f6;}
/* screenplay mode overrides for timeline area */
.screenplay-editor-active #tlA{cursor:default!important;overflow:hidden!important;background:#fff;}
.screenplay-editor-active #tlC{transform:none!important;display:flex!important;flex-direction:column!important;position:relative!important;height:100%!important;align-items:stretch!important;}

/* ── TIMELINE ── */
.tl-area{flex:1;overflow:auto;position:relative;cursor:grab;}
.tl-area.panning{cursor:grabbing;}
.tl-container{position:relative;transform-origin:0 0;display:flex;flex-direction:row;align-items:flex-start;}

/* Ruler */
.ruler{position:sticky;left:0;z-index:20;width:60px;flex-shrink:0;background:var(--bg2);border-right:1px solid var(--brd);}
.rtick{position:absolute;left:0;right:0;font-family:'Courier New',Consolas,monospace;font-size:9px;color:var(--tx4);padding-left:4px;}
.rtick.minor{border-top:1px solid var(--brd);}
.rtick.major{border-top:1px solid var(--tx4);color:var(--tx3);}

/* Snap guide */
.snap-guide{position:absolute;left:0;right:0;height:1px;background:var(--cyan);z-index:25;pointer-events:none;opacity:0;transition:opacity .1s;}
.snap-guide.show{opacity:.6;}

/* Rows */
.ep-row{display:flex;flex-direction:column;border-right:1px solid var(--brd);min-width:180px;position:relative;}
.ep-row:nth-child(even){background:rgba(255,255,255,.008);}
.ep-hdr{height:60px;flex-shrink:0;display:flex;flex-direction:column;align-items:center;justify-content:center;background:var(--bg2);border-bottom:1px solid var(--brd);position:sticky;top:0;z-index:10;gap:2px;width:100%;}
.ep-hdr .num{font-size:22px;font-weight:700;}
.ep-hdr .sub{font-size:9px;color:var(--tx3);font-weight:500;}
.ep-hdr .dur{font-family:'Courier New',monospace;font-size:9px;color:var(--tx4);margin-top:2px;}
.ep-body{position:relative;flex-shrink:0;}

/* Gridlines */
.gl{position:absolute;left:0;right:0;height:1px;pointer-events:none;}
.gl.mi{background:rgba(255,255,255,.025);}
.gl.ma{background:rgba(255,255,255,.07);}

/* Heatmap overlay */
.heatmap-bar{position:absolute;right:0;width:3px;pointer-events:none;border-radius:1px;opacity:.6;}

/* ── EVENT BLOCKS ── */
.evb{position:absolute;border-radius:var(--radius);z-index:5;display:flex;flex-direction:column;align-items:flex-start;padding:6px 8px;overflow:hidden;cursor:grab;user-select:none;border:1px solid;transition:box-shadow .15s,transform .1s;font-size:12px;font-weight:500;}
.evb:hover{z-index:15;box-shadow:0 4px 20px rgba(0,0,0,.5);transform:scale(1.02);}
.evb.selected{box-shadow:0 0 0 2px var(--cyan)!important;z-index:16;}
.evb.drag{opacity:.85;z-index:50;box-shadow:0 8px 32px rgba(0,0,0,.7);cursor:grabbing;transform:scale(1.04);}
.evb.ghost{opacity:.3!important;pointer-events:none;z-index:4;}
.evb.dim{opacity:.1!important;}
.evb.hl{box-shadow:0 0 0 2px rgba(255,255,255,.5)!important;z-index:16;}
.evb.warn-hl{box-shadow:0 0 0 2px var(--orange),0 0 16px rgba(249,115,22,.5)!important;z-index:20;opacity:1!important;}
.evb.collision{box-shadow:0 0 0 2px var(--red)!important;}
.evb.impact-1{box-shadow:0 0 0 2px var(--red),0 0 12px rgba(239,68,68,.4)!important;z-index:17;}
.evb.impact-2{box-shadow:0 0 0 2px var(--orange),0 0 12px rgba(249,115,22,.3)!important;z-index:17;}
.evb.impact-3{box-shadow:0 0 0 2px var(--yellow),0 0 12px rgba(245,158,11,.2)!important;z-index:17;}
.evb .etxt{white-space:normal;word-break:break-word;line-height:1.3;overflow:hidden;pointer-events:none;flex:1;}
.evb .scene-link{font-size:10px;opacity:.5;margin-left:4px;pointer-events:none;}
.evb .rh{position:absolute;left:0;height:7px;width:100%;cursor:ns-resize;z-index:6;}
.evb .rh:hover{background:rgba(255,255,255,.15);}
.evb .rh.l{top:0;border-radius:var(--radius) var(--radius) 0 0;}
.evb .rh.r{bottom:0;border-radius:0 0 var(--radius) var(--radius);}

/* Drop zone */
.ep-body.drop-target{background:rgba(59,130,246,.06)!important;outline:2px dashed var(--blue);outline-offset:-2px;}

/* ── RIGHT PANELS ── */
.rpanel{width:0;background:var(--bg2);border-left:1px solid var(--brd);overflow:hidden;transition:width .2s ease;flex-shrink:0;display:flex;flex-direction:column;}
.rpanel.open{width:320px;}
.rpanel-hdr{padding:10px 14px;border-bottom:1px solid var(--brd);display:flex;justify-content:space-between;align-items:center;flex-shrink:0;background:var(--bg2);z-index:2;}
.rpanel-hdr h3{font-size:13px;font-weight:600;display:flex;align-items:center;gap:6px;}
.rpanel-body{flex:1;overflow-y:auto;}
.close-btn{background:none;border:none;color:var(--tx3);cursor:pointer;font-size:16px;padding:4px;border-radius:4px;line-height:1;}
.close-btn:hover{color:var(--tx);background:var(--bg4);}

/* Tabs */
.rtabs{display:flex;border-bottom:1px solid var(--brd);background:var(--bg3);flex-shrink:0;}
.rtab{flex:1;padding:8px 6px;text-align:center;font-size:10px;color:var(--tx3);cursor:pointer;border-bottom:2px solid transparent;transition:all .15s;font-family:inherit;background:none;border-top:none;border-left:none;border-right:none;}
.rtab:hover{color:var(--tx2);}
.rtab.active{color:var(--tx);border-bottom-color:var(--blue);}

/* Warning items */
.wi{padding:10px 14px;border-bottom:1px solid var(--brd);cursor:pointer;transition:background .12s;}
.wi:hover{background:var(--bg3);}
.wi.active{background:var(--bg4);border-left:3px solid var(--orange);}
.wi .wt{font-size:12px;font-weight:500;margin-bottom:3px;}
.wi .wd{font-size:11px;color:var(--tx3);line-height:1.4;}
.wi .wf{margin-top:6px;display:flex;gap:4px;}
.nw{padding:20px 14px;text-align:center;color:var(--tx3);font-size:12px;}

/* Edit panel form */
.fg{margin-bottom:10px;}
.fg label{display:block;font-size:10px;color:var(--tx3);text-transform:uppercase;letter-spacing:.5px;margin-bottom:3px;font-weight:500;}
.fg input,.fg textarea,.fg select{width:100%;padding:6px 8px;border-radius:4px;border:1px solid var(--brd);background:var(--bg3);color:var(--tx);font-family:inherit;font-size:12px;outline:none;transition:border-color .15s;}
.fg input:focus,.fg textarea:focus,.fg select:focus{border-color:var(--blue);}
.fg textarea{resize:vertical;min-height:50px;}
.chw{display:flex;flex-wrap:wrap;gap:4px;}
.chcb{display:flex;align-items:center;gap:3px;font-size:11px;color:var(--tx2);cursor:pointer;}
.chcb input{width:auto;margin:0;}
.epf{padding:10px 14px;border-top:1px solid var(--brd);display:flex;gap:6px;flex-shrink:0;background:var(--bg2);}
.epc{margin-top:10px;padding-top:10px;border-top:1px solid var(--brd);}
.eci{display:flex;align-items:center;justify-content:space-between;padding:4px 0;font-size:11px;color:var(--tx2);}

/* Analysis specific */
.char-row{padding:8px 14px;border-bottom:1px solid var(--brd);cursor:pointer;transition:background .12s;}
.char-row:hover{background:var(--bg3);}
.char-bar{height:6px;border-radius:3px;margin-top:4px;transition:width .3s;}
.tempo-row{display:flex;align-items:center;gap:8px;padding:6px 14px;border-bottom:1px solid var(--brd);font-size:11px;}
.tempo-bar{flex:1;height:8px;background:var(--bg4);border-radius:4px;overflow:hidden;}
.tempo-fill{height:100%;border-radius:4px;transition:width .3s;}
.impact-info{padding:14px;background:var(--bg3);border-radius:var(--radius);margin:10px 14px;font-size:12px;line-height:1.6;}

/* ── STATUS BAR ── */
.statusbar{height:28px;background:var(--bg2);border-top:1px solid var(--brd);display:flex;align-items:center;padding:0 16px;gap:16px;font-size:11px;color:var(--tx3);flex-shrink:0;z-index:40;}
.statusbar .st-item{display:flex;align-items:center;gap:4px;}
.statusbar .st-sep{width:1px;height:14px;background:var(--brd);}
.statusbar .st-warn{color:var(--orange);cursor:pointer;}
.statusbar .st-warn:hover{color:var(--yellow);}

/* ── TOOLTIP ── */
.ttp{position:fixed;background:var(--bg4);border:1px solid var(--brd2);border-radius:var(--radius);padding:10px 14px;z-index:200;pointer-events:none;max-width:300px;box-shadow:var(--shadow);display:none;font-size:12px;}
.ttp.show{display:block;}
.ttp .tt{font-weight:600;margin-bottom:4px;}
.ttp .td{color:var(--tx2);font-size:11px;line-height:1.5;}
.ttp .tm{font-family:'Courier New',monospace;font-size:10px;color:var(--tx3);margin-top:4px;}

/* ── CONTEXT MENU ── */
.ctx-menu{position:fixed;background:var(--bg3);border:1px solid var(--brd2);border-radius:var(--radius);z-index:250;min-width:180px;box-shadow:var(--shadow);padding:4px 0;display:none;}
.ctx-menu.show{display:block;}
.ctx-item{padding:7px 14px;font-size:12px;cursor:pointer;display:flex;align-items:center;gap:8px;color:var(--tx2);transition:all .1s;}
.ctx-item:hover{background:var(--bg4);color:var(--tx);}
.ctx-item.danger{color:var(--red);}
.ctx-item.danger:hover{background:rgba(239,68,68,.1);}
.ctx-sep{height:1px;background:var(--brd);margin:4px 0;}

/* ── MODAL ── */
.mbg{position:fixed;inset:0;background:rgba(0,0,0,.6);z-index:300;display:none;align-items:center;justify-content:center;backdrop-filter:blur(2px);}
.mbg.open{display:flex;}
.mdl{background:var(--bg2);border:1px solid var(--brd);border-radius:8px;width:480px;max-height:80vh;overflow-y:auto;box-shadow:0 20px 60px rgba(0,0,0,.6);}
.mh{padding:14px 16px;border-bottom:1px solid var(--brd);display:flex;justify-content:space-between;align-items:center;font-size:14px;font-weight:600;}
.mb{padding:16px;}
.mf{padding:12px 16px;border-top:1px solid var(--brd);display:flex;justify-content:flex-end;gap:6px;}

/* ── TOAST ── */
.tbox{position:fixed;bottom:44px;left:50%;transform:translateX(-50%);z-index:400;display:flex;flex-direction:column;gap:6px;align-items:center;}
.tst{padding:8px 16px;background:var(--bg4);border:1px solid var(--brd2);border-radius:var(--radius);font-size:12px;box-shadow:var(--shadow);animation:toast-in .25s ease,toast-out .25s ease 2.3s forwards;white-space:nowrap;}
@keyframes toast-in{from{opacity:0;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}
@keyframes toast-out{from{opacity:1}to{opacity:0;transform:translateY(-6px)}}

/* ── SCROLLBAR ── */
::-webkit-scrollbar{width:6px;height:6px;}
::-webkit-scrollbar-track{background:transparent;}
::-webkit-scrollbar-thumb{background:var(--brd);border-radius:3px;}
::-webkit-scrollbar-thumb:hover{background:var(--brd2);}

/* ── SYNC / COLLABORATION ── */
.sync-bar{display:none;align-items:center;gap:8px;margin-right:8px;}
.sync-bar.active{display:flex;}
.sync-dot{width:8px;height:8px;border-radius:50%;flex-shrink:0;transition:background .3s;}
.sync-dot.connected{background:var(--green);}
.sync-dot.connecting{background:var(--yellow);animation:syncPulse 1s infinite;}
.sync-dot.disconnected{background:var(--red);}
@keyframes syncPulse{0%,100%{opacity:1;}50%{opacity:.4;}}
.sync-status-text{font-size:10px;color:var(--tx3);white-space:nowrap;}
.presence-bar{display:flex;align-items:center;gap:4px;}
.presence-avatar{width:26px;height:26px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:11px;font-weight:700;color:#fff;cursor:default;border:2px solid var(--bg2);position:relative;flex-shrink:0;transition:transform .15s;}
.presence-avatar:hover{transform:scale(1.15);z-index:1;}
.presence-avatar .pa-tip{display:none;position:absolute;bottom:-24px;left:50%;transform:translateX(-50%);background:var(--bg4);color:var(--tx);font-size:10px;padding:2px 8px;border-radius:4px;white-space:nowrap;pointer-events:none;z-index:99;}
.presence-avatar:hover .pa-tip{display:block;}
.room-code{font-family:'Courier New',monospace;font-size:12px;color:var(--cyan);background:var(--bg);padding:3px 8px;border-radius:4px;border:1px solid var(--brd);cursor:pointer;letter-spacing:1px;font-weight:600;transition:all .15s;}
.room-code:hover{background:var(--bg3);border-color:var(--cyan);}
.btn-leave{background:var(--red);border-color:var(--red);color:#fff;font-size:11px;padding:5px 10px;}
.btn-leave:hover{background:#dc2626;border-color:#dc2626;}
.sync-modal-body{display:flex;gap:16px;margin-top:12px;}
.sync-modal-col{flex:1;background:var(--bg);border:1px solid var(--brd);border-radius:var(--radius);padding:16px;display:flex;flex-direction:column;gap:10px;}
.sync-modal-col h3{font-size:13px;color:var(--tx2);margin-bottom:4px;}
.sync-modal-col input{width:100%;padding:8px 10px;border-radius:var(--radius);border:1px solid var(--brd);background:var(--bg3);color:var(--tx);font-family:inherit;font-size:13px;outline:none;}
.sync-modal-col input:focus{border-color:var(--blue);}
.sync-modal-col .btn{width:100%;justify-content:center;margin-top:4px;}
.sync-name-row{margin-bottom:8px;}
.sync-name-row label{font-size:11px;color:var(--tx3);display:block;margin-bottom:4px;}
.sync-name-row input{width:100%;padding:8px 10px;border-radius:var(--radius);border:1px solid var(--brd);background:var(--bg3);color:var(--tx);font-family:inherit;font-size:13px;outline:none;}
.sync-name-row input:focus{border-color:var(--blue);}
.sync-info{font-size:11px;color:var(--tx3);line-height:1.5;margin-top:8px;}
.sync-room-info{background:var(--bg);border:1px solid var(--brd);border-radius:var(--radius);padding:12px;margin-top:12px;display:flex;flex-direction:column;gap:8px;}
.sync-room-info .room-code{font-size:16px;text-align:center;display:block;padding:8px;letter-spacing:2px;}

/* ── PROJECTS SCREEN ── */
#projectsScreen{position:fixed;inset:0;background:var(--bg);z-index:500;overflow-y:auto;}
.ps-inner{max-width:720px;margin:0 auto;padding:48px 24px;}
.ps-header{text-align:center;margin-bottom:32px;}
.ps-header h1{font-size:24px;font-weight:700;}
.ps-header p{font-size:13px;color:var(--tx3);margin-top:6px;}
.ps-actions{display:flex;gap:8px;justify-content:center;margin-bottom:32px;flex-wrap:wrap;}
.ps-list{display:grid;grid-template-columns:1fr 1fr;gap:12px;}
.ps-card{background:var(--bg2);border:1px solid var(--brd);border-radius:8px;padding:16px;cursor:pointer;transition:all .15s;}
.ps-card:hover{border-color:var(--blue);background:var(--bg3);}
.ps-card-title{font-size:15px;font-weight:600;margin-bottom:6px;}
.ps-card-stats{font-size:11px;color:var(--tx2);margin-bottom:4px;}
.ps-card-date{font-size:10px;color:var(--tx3);}
.ps-card-actions{display:flex;gap:6px;margin-top:10px;}
.ps-empty{text-align:center;color:var(--tx3);padding:40px 0;font-size:13px;grid-column:1/-1;}

/* ── CHANGELOG ── */
.cl-entry{padding:8px 14px;border-bottom:1px solid var(--brd);}
.cl-entry:hover{background:var(--bg3);}
.cl-hdr{display:flex;justify-content:space-between;align-items:center;margin-bottom:3px;}
.cl-user{font-size:11px;font-weight:600;}
.cl-time{font-size:10px;color:var(--tx3);}
.cl-desc{font-size:11px;color:var(--tx2);}

/* ── NOTES ── */
.notes-compose{padding:10px 14px;border-bottom:1px solid var(--brd);background:var(--bg3);}
.notes-compose textarea{width:100%;min-height:60px;padding:8px;border-radius:var(--radius);border:1px solid var(--brd);background:var(--bg);color:var(--tx);font-family:inherit;font-size:12px;resize:vertical;outline:none;}
.notes-compose textarea:focus{border-color:var(--blue);}
.notes-compose .notes-compose-bar{display:flex;justify-content:flex-end;margin-top:6px;}
.note-item{padding:10px 14px;border-bottom:1px solid var(--brd);}
.note-item:hover{background:var(--bg3);}
.note-hdr{display:flex;align-items:center;gap:6px;margin-bottom:4px;}
.note-author{font-size:11px;font-weight:600;}
.note-time{font-size:10px;color:var(--tx3);flex:1;}
.note-actions{display:flex;gap:4px;}
.note-text{font-size:12px;color:var(--tx2);white-space:pre-wrap;word-break:break-word;}

/* ── AI ASSISTANT ── */
.ai-spinner{display:inline-block;width:16px;height:16px;border:2px solid var(--brd2);border-top-color:var(--purple);border-radius:50%;animation:aiSpin .6s linear infinite;vertical-align:middle;margin-right:6px;}
@keyframes aiSpin{to{transform:rotate(360deg);}}
.ai-feature-btn{width:100%;text-align:left;padding:8px 12px;margin-bottom:4px;border-radius:var(--radius);border:1px solid var(--brd);background:var(--bg3);color:var(--tx2);font-family:inherit;font-size:12px;cursor:pointer;transition:all .15s;display:flex;align-items:center;gap:8px;}
.ai-feature-btn:hover{background:var(--bg4);color:var(--tx);border-color:var(--purple);}
.ai-feature-btn:disabled{opacity:.5;cursor:not-allowed;}
.ai-response-stream{background:var(--bg);border:1px solid var(--brd);border-radius:var(--radius);padding:12px;margin-top:8px;font-family:'Courier New',monospace;font-size:12px;color:var(--tx2);line-height:1.6;max-height:400px;overflow-y:auto;white-space:pre-wrap;word-break:break-word;}
.ai-tab-bar{display:flex;gap:2px;background:var(--bg);border-radius:var(--radius);padding:2px;border:1px solid var(--brd);margin-bottom:8px;}
.ai-tab{flex:1;padding:6px 8px;border-radius:4px;font-size:11px;cursor:pointer;color:var(--tx3);border:none;background:none;font-family:inherit;transition:all .15s;text-align:center;}
.ai-tab.active{background:var(--bg4);color:var(--tx);}
.ai-tab:hover:not(.active){color:var(--tx2);}
.ai-config-section{padding:10px 0;border-top:1px solid var(--brd);margin-top:8px;}
.ai-config-section label{font-size:11px;color:var(--tx3);display:block;margin-bottom:4px;}
.ai-msg{padding:8px 12px;margin-bottom:6px;border-radius:var(--radius);font-size:12px;line-height:1.5;}
.ai-msg.user{background:var(--bg4);color:var(--tx);border:1px solid var(--brd);}
.ai-msg.assistant{background:linear-gradient(135deg,rgba(168,85,247,.08),rgba(59,130,246,.08));color:var(--tx2);border:1px solid rgba(168,85,247,.2);}

/* ── MEDIUM SCREENS (tablets, small laptops, Windows 125% scaling) ── */
@media(max-width:1200px){
  .topbar{padding:6px 10px;}
  .logo span{display:none;}
  .tba .sep{display:none;}
  .btn{padding:6px 10px;font-size:11px;}
  .btn-icon{padding:5px 7px;font-size:13px;}
  .view-mode{padding:4px 10px;font-size:10px;}
  #zLvl{display:none;}
  .toolbar{padding:4px 10px;gap:6px;}
  .pill{padding:2px 8px;font-size:10px;}
}

/* ── MOBILE ── */
@media(max-width:768px){
  /* Projects screen mobile */
  .ps-list{grid-template-columns:1fr;}
  .ps-inner{padding:24px 16px;}
  /* Sync mobile */
  .sync-bar{gap:4px;margin-right:4px;}
  .sync-status-text{display:none;}
  .presence-avatar{width:22px;height:22px;font-size:9px;}
  .room-code{font-size:10px;padding:2px 6px;}
  .sync-modal-body{flex-direction:column;}
  /* Topbar */
  .topbar{min-height:auto;padding:8px 10px;gap:6px;}
  .logo{width:100%;justify-content:space-between;}
  .logo h1{font-size:14px;} .logo span{display:none;}
  .view-modes{order:1;}
  .tba{order:2;width:100%;flex-wrap:wrap;gap:4px;justify-content:flex-start;}
  .tba .sep{display:none;}
  .tba .btn{padding:6px 8px;font-size:11px;}
  .tba .btn-icon{padding:5px 7px;font-size:12px;}
  #zLvl{display:none;}

  /* Toolbar */
  .toolbar{padding:4px 10px;gap:6px;min-height:36px;}
  .toolbar label{font-size:9px;}
  .toolbar select{padding:3px 6px;font-size:11px;}
  #catP{display:none!important;} /* Hide category pills on mobile */

  /* Main layout — stack vertically */
  .main-wrap{flex-direction:column;}

  /* Screenplay panel — full width overlay */
  .sp-panel{width:100%!important;max-height:50vh;border-right:none;border-bottom:1px solid var(--brd);z-index:35;}
  .sp-panel.open{width:100%!important;}
  .sp-resize{display:none;}

  /* Timeline — full width */
  .tl-area{flex:1;min-height:200px;-webkit-overflow-scrolling:touch;}

  /* Right panel — full width overlay */
  .rpanel{position:fixed;bottom:0;left:0;right:0;width:100%!important;max-height:60vh;border-left:none;border-top:1px solid var(--brd);z-index:60;border-radius:12px 12px 0 0;}
  .rpanel.open{width:100%!important;}

  /* Event blocks — larger touch targets */
  .evb{font-size:11px;min-height:40px;}
  .evb .rh{height:12px;} /* Wider resize handles for touch */

  /* Episode headers */
  .ep-hdr{height:50px;}
  .ep-hdr .num{font-size:18px;}
  .ep-hdr .sub{font-size:8px;} .ep-hdr .dur{font-size:8px;}
  .ruler{width:44px;}

  /* Scene cards */
  .scene-card{padding:8px 10px;}
  .scene-meta-row{flex-direction:column;gap:4px;}
  .scene-meta-field{flex:1 1 100%!important;}
  .scene-screenplay{min-height:100px;font-size:13px;}

  /* Modal — nearly full screen on mobile */
  .mdl{width:calc(100% - 16px)!important;max-width:100%;max-height:calc(100vh - 40px);border-radius:10px;margin:8px;}
  .mbg{align-items:center;padding:0;}

  /* Status bar */
  .statusbar{height:auto;padding:4px 10px;flex-wrap:wrap;gap:4px 10px;font-size:10px;}
  .statusbar .st-sep{display:none;}
  #stProj{display:none;}

  /* Toast */
  .tbox{bottom:80px;left:10px;right:10px;transform:none;}

  /* Tooltip — hide on mobile */
  .ttp{display:none!important;}

  /* Context menu */
  .ctx-menu{position:fixed;bottom:0;left:0;right:0;top:auto;border-radius:12px 12px 0 0;min-width:100%;max-height:60vh;overflow-y:auto;}

  /* Mention popup */
  .mention-popup{max-height:150px;}
  .mention-popup .mp-item{padding:10px 14px;font-size:13px;}

  /* Scrollbar — hide on mobile */
  ::-webkit-scrollbar{width:3px;height:3px;}
}

/* Small phone */
@media(max-width:400px){
  .topbar{padding:6px 8px;}
  .tba .btn{padding:5px 6px;font-size:10px;}
  .view-mode{padding:4px 8px;font-size:10px;}
  .sp-panel.open{max-height:45vh;}
  .ep-hdr{height:40px;}
  .ep-hdr .num{font-size:15px;}
  .ep-hdr .sub,.ep-hdr .dur{display:none;}
  .ruler{width:36px;}
  .evb{font-size:10px;padding:4px 6px;}
}

/* ── PRINT ── */
@media print{
  .topbar,.toolbar,.sp-panel,.rpanel,.ttp,.mbg,.tbox,.statusbar,.ctx-menu{display:none!important;}
  .main-wrap{overflow:visible!important;}
  .tl-area{overflow:visible!important;cursor:default!important;}
  .tl-container{transform:none!important;}
  body{background:#fff;color:#111;overflow:visible;height:auto;}
  .ep-hdr{background:#f5f5f5!important;color:#111;}
  .ep-hdr .num,.ep-hdr .sub,.ep-hdr .dur{color:#111!important;}
  .ep-row{border-color:#ccc!important;}
  .evb{border-width:2px!important;font-weight:600!important;color:#111!important;}
  .gl.ma{background:rgba(0,0,0,.12)!important;}
  .gl.mi{background:rgba(0,0,0,.05)!important;}
  .ruler{background:#f5f5f5!important;border-color:#ccc!important;}
  .rtick{color:#666!important;border-color:#999!important;}
}

/* ── AUTH SCREEN ── */
.auth-tabs{display:flex;gap:2px;background:var(--bg);border-radius:var(--radius);padding:2px;border:1px solid var(--brd);margin-bottom:20px;}
.auth-tab{flex:1;padding:8px;border:none;background:none;color:var(--tx3);cursor:pointer;font-family:inherit;font-size:13px;border-radius:4px;transition:all .15s;}
.auth-tab.active{background:var(--bg4);color:var(--tx);}
.auth-form{max-width:360px;margin:0 auto;}
.auth-form input{width:100%;padding:10px 12px;margin-bottom:10px;border:1px solid var(--brd);border-radius:var(--radius);background:var(--bg3);color:var(--tx);font-family:inherit;font-size:13px;outline:none;}
.auth-form input:focus{border-color:var(--blue);}
.auth-form .btn{width:100%;padding:10px;margin-top:4px;}
.auth-error{color:var(--red);font-size:12px;margin-bottom:8px;display:none;}

/* ── USER INFO (topbar) ── */
.user-info{display:flex;align-items:center;gap:8px;font-size:12px;color:var(--tx2);}
.user-avatar{width:28px;height:28px;border-radius:50%;background:var(--blue);color:#fff;display:flex;align-items:center;justify-content:center;font-size:12px;font-weight:600;}

/* ── READONLY MODE (viewer) ── */
.readonly-mode .sp-add-scene-btn,
.readonly-mode .sp-block-actions,
.readonly-mode .btn-p[onclick*="addEvent"],
.readonly-mode .btn-p[onclick*="addScene"],
.readonly-mode #tb{display:none !important;}
.readonly-mode .sp-scene-header select,
.readonly-mode .sp-scene-header input{pointer-events:none;opacity:.7;}
.readonly-badge{background:var(--orange);color:#fff;font-size:10px;padding:2px 8px;border-radius:4px;font-weight:600;display:none;}
.readonly-mode .readonly-badge{display:inline-block;}

/* ── PROJECT CARD ROLE BADGE ── */
.ps-card-role{font-size:10px;padding:2px 8px;border-radius:4px;font-weight:600;}
.ps-card-role.owner{background:var(--blue);color:#fff;}
.ps-card-role.editor{background:var(--green);color:#fff;}
.ps-card-role.viewer{background:var(--orange);color:#fff;}

/* ── MEMBER LIST (share modal) ── */
.member-row{display:flex;align-items:center;gap:8px;padding:6px 0;border-bottom:1px solid var(--brd);}
.member-row:last-child{border:none;}
.member-email{flex:1;font-size:12px;color:var(--tx);}
.member-role{font-size:11px;color:var(--tx2);}

/* ── RELATIONSHIP MAP ── */
.rm-toolbar{height:40px;background:var(--bg2);border-bottom:1px solid var(--brd);display:flex;align-items:center;padding:4px 16px;gap:8px;flex-shrink:0;z-index:10;position:relative;}
.rm-node{transition:opacity .2s;}
.rm-node:hover{opacity:1;}
.rm-node:hover>circle:not(.rm-glow){filter:brightness(1.15);}
.rm-edge path{transition:stroke-opacity .2s;}
.rm-edge:hover path:nth-child(2){stroke-opacity:0.8!important;}
.rm-edge.selected path:nth-child(2){stroke-opacity:0.95!important;}

/* ── EXPORT MODAL ── */
.export-tab{flex:1;padding:8px;border:none;background:none;color:var(--tx3);cursor:pointer;font-family:inherit;font-size:12px;border-radius:4px;transition:all .15s;text-align:center;}
.export-tab.active{background:var(--bg4);color:var(--tx);}
.export-tab:hover:not(.active){color:var(--tx2);}

/* ── REVIEW / TRACK CHANGES ── */
.review-mode-active #reviewToggleBtn{background:var(--green);border-color:var(--green);color:#fff;}
.track-add{border-bottom:2px solid var(--green);background:rgba(16,185,129,.1);border-radius:2px;}
.track-del{text-decoration:line-through;color:var(--red);opacity:.7;}
.review-comment{background:rgba(255,255,0,.15);border-bottom:2px solid var(--yellow);border-radius:2px;cursor:pointer;}
.review-panel-entry{transition:background .12s;}
.review-panel-entry:hover{background:var(--bg3);}
.review-mode-active .sp-editor-toolbar::after{content:'İNCELEME MODU';font-size:10px;color:var(--green);font-weight:600;letter-spacing:1px;margin-left:auto;}
.review-mode-active .scene-screenplay{border-color:var(--green)!important;}

/* ── TEMPLATE MODAL ── */
.template-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(180px,1fr));gap:12px;}
.template-card{background:var(--bg3);border:1px solid var(--brd);border-radius:8px;padding:16px;cursor:pointer;transition:all .15s;text-align:center;}
.template-card:hover{border-color:var(--blue);background:var(--bg4);transform:translateY(-2px);box-shadow:0 4px 16px rgba(0,0,0,.3);}
.template-card-icon{font-size:32px;margin-bottom:8px;}
.template-card-title{font-size:13px;font-weight:600;margin-bottom:4px;color:var(--tx);}
.template-card-desc{font-size:11px;color:var(--tx3);line-height:1.4;margin-bottom:10px;min-height:32px;}
.template-card-meta{display:flex;justify-content:center;gap:8px;font-size:10px;color:var(--tx4);}
.template-card-meta span{background:var(--bg);padding:2px 6px;border-radius:4px;}

/* Kartlar mode — container overrides */
.kartlar-active #tlA { cursor: default; overflow-y: auto; overflow-x: auto; }
.kartlar-active #tlC { display: flex; flex-direction: column; align-items: stretch; height: 100%; }

/* ── CORKBOARD / KARTLAR ── */
.corkboard-container{padding:16px;overflow-y:auto;height:100%;}
.corkboard-toolbar{display:flex;align-items:center;gap:8px;padding:8px 16px;background:var(--bg2);border-bottom:1px solid var(--brd);flex-shrink:0;}
.corkboard-toolbar select{padding:4px 8px;border-radius:4px;border:1px solid var(--brd);background:var(--bg3);color:var(--tx2);font-size:12px;font-family:inherit;cursor:pointer;outline:none;}
.corkboard-section{margin-bottom:24px;}
.corkboard-section-title{font-size:13px;font-weight:600;color:var(--tx2);padding:8px 0;border-bottom:1px solid var(--brd);margin-bottom:12px;display:flex;align-items:center;gap:8px;}
.corkboard-section-count{font-size:11px;color:var(--tx4);font-weight:400;}
.corkboard-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(220px,1fr));gap:12px;}
.cork-card{background:var(--bg3);border:1px solid var(--brd);border-radius:var(--radius);padding:0;cursor:grab;transition:all .15s;overflow:hidden;user-select:none;position:relative;}
.cork-card:hover{border-color:var(--blue);box-shadow:0 4px 16px rgba(0,0,0,.3);transform:translateY(-1px);}
.cork-card.selected{box-shadow:0 0 0 2px var(--cyan);}
.cork-card.dragging{opacity:.5;transform:scale(.95);box-shadow:0 8px 24px rgba(0,0,0,.5);}
.cork-card-color-bar{height:4px;width:100%;}
.cork-card-body{padding:10px 12px;}
.cork-card-title{font-size:12px;font-weight:600;margin-bottom:6px;color:var(--tx);line-height:1.3;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;}
.cork-card-summary{font-size:11px;color:var(--tx3);line-height:1.4;margin-bottom:8px;overflow:hidden;display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;min-height:30px;}
.cork-card-meta{display:flex;align-items:center;gap:8px;font-size:10px;color:var(--tx4);}
.cork-card-meta span{display:flex;align-items:center;gap:3px;}
.cork-card-placeholder{border:2px dashed var(--blue);border-radius:var(--radius);background:rgba(59,130,246,.05);min-height:80px;transition:all .15s;}
.cork-card.drag-over-before{border-top:2px dashed var(--blue);}
.cork-card.drag-over-after{border-bottom:2px dashed var(--blue);}
.cork-add-scene-btn{background:var(--bg3);border:1px dashed var(--brd2);border-radius:var(--radius);padding:12px;text-align:center;cursor:pointer;color:var(--tx3);font-size:12px;transition:all .15s;min-height:60px;display:flex;align-items:center;justify-content:center;gap:6px;}
.cork-add-scene-btn:hover{border-color:var(--blue);color:var(--blue);background:rgba(59,130,246,.05);}
.corkboard-grid.drag-over{background:rgba(59,130,246,.03);border-radius:var(--radius);}

/* ── CHRONOLOGY / GANTT CHART ── */
.kronoloji-active #tlA{cursor:default;overflow:hidden;}
.kronoloji-active #tlC{display:flex;flex-direction:column;align-items:stretch;height:100%;transform:none!important;}

.gantt-toolbar{display:flex;align-items:center;gap:10px;padding:8px 16px;background:var(--bg2);border-bottom:1px solid var(--brd);flex-shrink:0;flex-wrap:wrap;}
.gantt-zoom-group{display:flex;align-items:center;gap:4px;}
.gantt-zoom-btn{padding:4px 10px;border-radius:4px;border:1px solid var(--brd);background:var(--bg3);color:var(--tx3);font-size:11px;font-family:inherit;cursor:pointer;transition:all .12s;}
.gantt-zoom-btn:hover{border-color:var(--blue);color:var(--tx);}
.gantt-zoom-btn.active{background:var(--blue);color:#fff;border-color:var(--blue);}
.gantt-filter-group{display:flex;align-items:center;gap:6px;}
.gantt-filter-btn{padding:4px 8px;border-radius:4px;border:1px solid var(--brd);background:var(--bg3);color:var(--tx2);font-size:12px;font-family:inherit;cursor:pointer;outline:none;}
.gantt-no-data{padding:40px;text-align:center;color:var(--tx3);font-size:13px;}

.gantt-container{flex:1;overflow:auto;position:relative;}

/* Header */
.gantt-header{position:sticky;top:0;z-index:12;background:var(--bg2);}
.gantt-header-top{position:relative;height:22px;border-bottom:1px solid var(--brd);}
.gantt-header-year{position:absolute;top:0;height:22px;display:flex;align-items:center;justify-content:center;font-size:11px;font-weight:600;color:var(--tx);border-right:1px solid var(--brd);box-sizing:border-box;}
.gantt-header-bottom{position:relative;height:24px;border-bottom:2px solid var(--brd);}
.gantt-header-cell{position:absolute;top:0;height:24px;display:flex;align-items:center;justify-content:center;font-size:10px;color:var(--tx3);border-right:1px solid rgba(42,42,58,.3);box-sizing:border-box;}

/* Rows */
.gantt-rows{position:relative;}
.gantt-row{display:flex;border-bottom:1px solid var(--brd);position:relative;transition:background .12s;}
.gantt-row:hover{background:rgba(255,255,255,.02);}
.gantt-row.drop-target{background:rgba(59,130,246,.08);box-shadow:inset 0 0 0 1px var(--blue);}

.gantt-row-label{position:sticky;left:0;z-index:10;background:var(--bg2);border-right:1px solid var(--brd);padding:8px 12px;flex-shrink:0;display:flex;flex-direction:column;justify-content:center;gap:2px;}
.gantt-row-title{font-size:12px;font-weight:600;color:var(--tx);white-space:nowrap;overflow:hidden;text-overflow:ellipsis;}
.gantt-row-date{font-size:10px;color:var(--tx3);}
.gantt-row-count{font-size:10px;color:var(--tx4);}

.gantt-row-content{position:relative;flex-shrink:0;}

/* Grid lines */
.gantt-grid-line{position:absolute;top:0;bottom:0;width:1px;background:rgba(42,42,58,.15);pointer-events:none;}

/* Bars */
.gantt-bar{position:absolute;border-radius:4px;cursor:grab;display:flex;align-items:center;gap:4px;padding:0 6px;overflow:hidden;font-size:10px;color:#fff;font-weight:500;white-space:nowrap;z-index:5;transition:opacity .12s,box-shadow .12s;touch-action:none;user-select:none;}
.gantt-bar:hover{box-shadow:0 2px 8px rgba(0,0,0,.25);z-index:6;}
.gantt-bar.flashback{border:2px dashed #9c27b0;background:rgba(156,39,176,.6)!important;}
.gantt-bar.flashforward{border:2px dashed #00bcd4;background:rgba(0,188,212,.6)!important;}
.gantt-bar.dragging{opacity:.7;z-index:100;cursor:grabbing;box-shadow:0 4px 16px rgba(0,0,0,.4);}
.gantt-bar.has-warn .warn-icon{color:#ff9800;font-size:11px;flex-shrink:0;}
.gantt-bar-label{overflow:hidden;text-overflow:ellipsis;}

/* Flashback/Flashforward indicators for other views */
.timeline-bar.flashback{border:2px dashed #9c27b0;}
.timeline-bar.flashforward{border:2px dashed #00bcd4;}
.card.flashback{border-top:3px solid #9c27b0;}
.card.flashforward{border-top:3px solid #00bcd4;}

/* ── IMPORT PROGRESS ── */
.import-progress{padding:20px;text-align:center;}
.import-progress-bar{height:4px;background:var(--bg4);border-radius:2px;margin:12px 0;overflow:hidden;}
.import-progress-fill{height:100%;background:var(--blue);border-radius:2px;transition:width .3s;}
